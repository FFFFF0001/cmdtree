---
title: crypt()函数
date: 2017-03-25T12:30:22+00:00
layout: post
category: 网络技术与安全
---

# 数据加密

数据加密利用密码技术对信息进行加密，实现信息的隐蔽，从而起到保护信息安全的作用。它通过加密算法和加密秘钥将原来是明文的文件或数据进行处理，使其成文不可读的一段代码，也就是所谓的“密文”，来达到保护数据的安全性。

# Crypt()函数

crypt()函数返回使用DES、Blowfish或MD5算法加密的字符串。在不同的操作系统上，crypt()函数的行为不同，某些操作系统支持一种以上的算法类型。在安装时，PHP回忆检查什么算法可用以及使用什么算法。

**crypt()函数的语法：**

```
string crypt(string str[,string salt]);
```

参数str：必需。是需要加密的字符串。

参数salt：可选。用于增加被加密字符数目的字符串（干扰串），以使字符更加安全。若没有提供salt参数，每次调用该函数时会随机生成一个干扰串。

**crypt()函数的算法：**

| 参数  | 介绍  |
| :------------ | :------------ |
| [CRYPT_SALT_LENGTH]  | 默认的加密长度。使用标准的 DES 加密，长度为 2  |
| [CRYPT_STD_DES] | 基于标准 DES 算法的散列使用 "./0-9A-Za-z" 字符中的两个字符作为盐值。在盐值中使用非法的字符将导致 crypt() 失败。  |
| [CRYPT_EXT_DES]  |  扩展的基于 DES 算法的散列。其盐值为 9 个字符的字符串，由 1 个下划线后面跟着 4 字节循环次数和 4 字节盐值组成。它们被编码成可打印字符，每个字符 6 位，有效位最少的优先。0 到 63 被编码为 "./0-9A-Za-z"。在盐值中使用非法的字符将导致 crypt() 失败。 |
| [CRYPT_MD5]  | MD5 散列使用一个以 $1$ 开始的 12 字符的字符串盐值。  |
| [CRYPT_BLOWFISH]   | Blowfish 算法使用如下盐值：“$2a$”，一个两位 cost 参数，“$” 以及 64 位由 “./0-9A-Za-z” 中的字符组合而成的字符串。在盐值中使用此范围之外的字符将导致 crypt() 返回一个空字符串。两位 cost 参数是循环次数以 2 为底的对数，它的范围是 04-31，超出这个范围将导致 crypt() 失败。  |
| CRYPT_SHA256  | SHA-256 算法使用一个以 $5$ 开头的 16 字符字符串盐值进行散列。如果盐值字符串以 “rounds=<N>$” 开头，N 的数字值将被用来指定散列循环的执行次数，这点很像 Blowfish 算法的 cost 参数。默认的循环次数是 5000，最小是 1000，最大是 999,999,999。超出这个范围的 N 将会被转换为最接近的值。  |
| CRYPT_SHA512 | SHA-512 算法使用一个以 $6$ 开头的 16 字符字符串盐值进行散列。如果盐值字符串以 “rounds=<N>$” 开头，N 的数字值将被用来指定散列循环的执行次数，这点很像 Blowfish 算法的 cost 参数。默认的循环次数是 5000，最小是 1000，最大是 999,999,999。超出这个范围的 N 将会被转换为最接近的值。在该函数支持多种算法的系统上，如果支持上述常量则设置为 "1"，否则设置为 "0"。|



```
<?php
    $str="This is example";  
    echo '加密前的值为：'.$str;
    $crypttostr=crypt($str);
    echo '<p>加密后$str的值为：'.$crypttostr;
 ?>

```
运行结果如图显示：

![](/pics/2017/03/742738-20160101133811354-215165089.png)
![](/pics/2017/03/742738-20160101133921964-1414775621.png)



从两幅运行结果图可以发现，刷新之后生成的加密结果都不相同，这就对加密后的数据进行判断就成了一个问题。而我们也知道crypt()函数是单向函数，密文不可以还原成明文。且每次加密后的数据都不相同，这就是salt参数要解决的问题。crypt()函数用salt参数对明文进行加密，判断时，对输出的信息再次使用相同的salt参数进行加密，对比两次加密后结果的判断。

> 注：crypt()函数没有相应的解码函数，它是一种单向加密函数。
